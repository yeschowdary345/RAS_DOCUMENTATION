Date: Wed, 3 Jan 2024 05:42:12 +0000 (UTC)
Message-ID: <2089533486.91.1704260532232@89ec1521d75b>
Subject: Exported From Confluence
MIME-Version: 1.0
Content-Type: multipart/related; 
	boundary="----=_Part_90_1825437102.1704260532232"

------=_Part_90_1825437102.1704260532232
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Content-Location: file:///C:/exported.html

<html xmlns:o=3D'urn:schemas-microsoft-com:office:office'
      xmlns:w=3D'urn:schemas-microsoft-com:office:word'
      xmlns:v=3D'urn:schemas-microsoft-com:vml'
      xmlns=3D'urn:w3-org-ns:HTML'>
<head>
    <meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8=
">
    <title>17.3 Asset Property Management</title>
    <!--[if gte mso 9]>
    <xml>
        <o:OfficeDocumentSettings>
            <o:TargetScreenSize>1024x640</o:TargetScreenSize>
            <o:PixelsPerInch>72</o:PixelsPerInch>
            <o:AllowPNG/>
        </o:OfficeDocumentSettings>
        <w:WordDocument>
            <w:View>Print</w:View>
            <w:Zoom>90</w:Zoom>
            <w:DoNotOptimizeForBrowser/>
        </w:WordDocument>
    </xml>
    <![endif]-->
    <style>
                <!--
        @page Section1 {
            size: 8.5in 11.0in;
            margin: 1.0in;
            mso-header-margin: .5in;
            mso-footer-margin: .5in;
            mso-paper-source: 0;
        }

        table {
            border: solid 1px;
            border-collapse: collapse;
        }

        table td, table th {
            border: solid 1px;
            padding: 5px;
        }

        td {
            page-break-inside: avoid;
        }

        tr {
            page-break-after: avoid;
        }

        div.Section1 {
            page: Section1;
        }

        /* Confluence print stylesheet. Common to all themes for print medi=
a */
/* Full of !important until we improve batching for print CSS */

@media print {
    #main {
        padding-bottom: 1em !important; /* The default padding of 6em is to=
o much for printouts */
    }

    body {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        font-size: 10pt;
        line-height: 1.2;
    }

    body, #full-height-container, #main, #page, #content, .has-personal-sid=
ebar #content {
        background: var(--ds-surface, #fff) !important;
        color: var(--ds-text, #000) !important;
        border: 0 !important;
        width: 100% !important;
        height: auto !important;
        min-height: auto !important;
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
    }

    a, a:link, a:visited, a:focus, a:hover, a:active {
        color: var(--ds-text, #000);
    }

    #content h1,
    #content h2,
    #content h3,
    #content h4,
    #content h5,
    #content h6 {
        font-family: Arial, Helvetica, FreeSans, sans-serif;
        page-break-after: avoid;
    }

    pre {
        font-family: Monaco, "Courier New", monospace;
    }

    #header,
    .aui-header-inner,
    #navigation,
    #sidebar,
    .sidebar,
    #personal-info-sidebar,
    .ia-fixed-sidebar,
    .page-actions,
    .navmenu,
    .ajs-menu-bar,
    .noprint,
    .inline-control-link,
    .inline-control-link a,
    a.show-labels-editor,
    .global-comment-actions,
    .comment-actions,
    .quick-comment-container,
    #addcomment {
        display: none !important;
    }

    /* CONF-28544 cannot print multiple pages in IE */
    #splitter-content {
        position: relative !important;
    }

    .comment .date::before {
        content: none !important; /* remove middot for print view */
    }

    h1.pagetitle img {
        height: auto;
        width: auto;
    }

    .print-only {
        display: block;
    }

    #footer {
        position: relative !important; /* CONF-17506 Place the footer at en=
d of the content */
        margin: 0;
        padding: 0;
        background: none;
        clear: both;
    }

    #poweredby {
        border-top: none;
        background: none;
    }

    #poweredby li.print-only {
        display: list-item;
        font-style: italic;
    }

    #poweredby li.noprint {
        display: none;
    }

    /* no width controls in print */
    .wiki-content .table-wrap,
    .wiki-content p,
    .panel .codeContent,
    .panel .codeContent pre,
    .image-wrap {
        overflow: visible !important;
    }

    /* TODO - should this work? */
    #children-section,
    #comments-section .comment,
    #comments-section .comment .comment-body,
    #comments-section .comment .comment-content,
    #comments-section .comment p {
        page-break-inside: avoid;
    }

    #page-children a {
        text-decoration: none;
    }

    /**
     hide twixies

     the specificity here is a hack because print styles
     are getting loaded before the base styles. */
    #comments-section.pageSection .section-header,
    #comments-section.pageSection .section-title,
    #children-section.pageSection .section-header,
    #children-section.pageSection .section-title,
    .children-show-hide {
        padding-left: 0;
        margin-left: 0;
    }

    .children-show-hide.icon {
        display: none;
    }

    /* personal sidebar */
    .has-personal-sidebar #content {
        margin-right: 0px;
    }

    .has-personal-sidebar #content .pageSection {
        margin-right: 0px;
    }

    .no-print, .no-print * {
        display: none !important;
    }
}
-->
    </style>
</head>
<body>
    <h1>17.3 Asset Property Management</h1>
    <div class=3D"Section1">
        <h2 class=3D"auto-cursor-target" id=3D"id-17.3AssetPropertyManageme=
nt-Introduction">Introduction</h2>
<p>This document describes how we will handle asset property metadata, how =
data will be curated, how it will be displayed etc.&nbsp;</p>
<h2 id=3D"id-17.3AssetPropertyManagement-TableofContents">Table of Contents=
</h2>
<style type=3D"text/css">/*<![CDATA[*/
div.rbtoc1704260532216 {padding: 0px;}
div.rbtoc1704260532216 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1704260532216 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style>
<div class=3D"toc-macro rbtoc1704260532216">=20
<ul class=3D"toc-indentation">=20
</ul>=20
</div>
<p><style type=3D"text/css">/*<![CDATA[*/
div.rbtoc1704260532215 {padding: 0px;}
div.rbtoc1704260532215 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1704260532215 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style></p>
<div class=3D"toc-macro rbtoc1704260532215">=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Introduction">Introduction</=
a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-TableofContents">Table of Co=
ntents</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Propertymetadata">Property m=
etadata</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-InitialCreation">Initial Cre=
ation</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Approaches">Approaches</a>=
=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Offline">Offline</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Online">Online</a></li>=20
</ul> </li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Presentation&amp;Impact">Pre=
sentation &amp; Impact</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-17.3AssetPropertyManagement-DataScaling:onwhatdoweapplyi=
t?">Data Scaling: on what do we apply it?</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Rangelimits:onwhatdoweapplyt=
hem?">Range limits: on what do we apply them?</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-17.3AssetPropertyManagement-DAEinputdata">DAE input data=
</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-FilterDataExport">Filter Dat=
a Export</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Units&amp;TheirUsage">Units =
&amp; Their Usage</a></li>=20
</ul> </li>=20
</ul> </li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-OnlineConversionDetails">Onl=
ine Conversion Details</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-OfflineConversionDetails">Of=
fline Conversion Details</a>=20
<ul class=3D"toc-indentation">=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Datamismatchhandling">Data m=
ismatch handling</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-ChangeManagement">Change Man=
agement</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Minallowablevalue">Min allow=
able value</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Maxallowablevalue">Max allow=
able value</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Unit">Unit</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Receive&amp;StoredScale">Rec=
eive &amp; Stored Scale</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Recalculationconsequences,pa=
rt1">Recalculation consequences, part 1</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Recalculationconsequences,pa=
rtDAE">Recalculation consequences, part DAE</a></li>=20
<li><a href=3D"#id-17.3AssetPropertyManagement-Recalculationconsequences,pa=
rt3">Recalculation consequences, part 3</a></li>=20
</ul> </li>=20
</ul>=20
</div>
<p></p>
<style type=3D"text/css">/*<![CDATA[*/
div.rbtoc1704260532216 {padding: 0px;}
div.rbtoc1704260532216 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1704260532216 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style>
<div class=3D"toc-macro rbtoc1704260532216">=20
<ul class=3D"toc-indentation">=20
</ul>=20
</div>
<h2 id=3D"id-17.3AssetPropertyManagement-Propertymetadata">Property metadat=
a</h2>
<p>The following metadata can be <span class=3D"inline-comment-marker" data=
-ref=3D"4a3aca6a-427a-420c-8603-e130e9bdd96e">assigned</span> to a floating=
 point &amp; text properties:</p>
<div class=3D"table-wrap">
<table class=3D"wrapped confluenceTable">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<th class=3D"confluenceTh"><br></th>
<th class=3D"confluenceTh">Float</th>
<th class=3D"confluenceTh">Text</th>
</tr>
<tr>
<td class=3D"confluenceTd">Minimal allowable value</td>
<td class=3D"confluenceTd">Optional</td>
<td class=3D"confluenceTd">Not allowed</td>
</tr>
<tr>
<td class=3D"confluenceTd">Maximum allowable value</td>
<td class=3D"confluenceTd">Optional</td>
<td class=3D"confluenceTd">Not allowed</td>
</tr>
<tr>
<td class=3D"confluenceTd">Unit with prefix</td>
<td class=3D"confluenceTd">Optional</td>
<td class=3D"confluenceTd">Optional</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd">Display Name</td>
<td colspan=3D"1" class=3D"confluenceTd">Required</td>
<td colspan=3D"1" class=3D"confluenceTd">Required</td>
</tr>
<tr>
<td colspan=3D"1" class=3D"confluenceTd">Conversion Factor</td>
<td colspan=3D"1" class=3D"confluenceTd">Optional</td>
<td colspan=3D"1" class=3D"confluenceTd"><p>Not allowed</p></td>
</tr>
</tbody>
</table>
</div>
<p>At this time, only float &amp; text properties are supported in RAS. Som=
e explanation of what these mean:</p>
<ol>
<li><strong>Minimum allowable value:</strong> expressed in store-scale, see=
 below</li>
<li><strong>Maximum allowable value:</strong> expressed in store-scale, see=
 below</li>
<li><span class=3D"inline-comment-marker" data-ref=3D"9b19a97f-c3a0-43cf-ae=
7b-c7759bb1f813"><strong>Unit with prefix:</strong> e.g. kV</span></li>
<li><span class=3D"inline-comment-marker" data-ref=3D"b05ea9ac-7b0a-4958-93=
c0-e5d64d72767d"><strong>Display name:</strong> a name that will be shown t=
o users in dashboards etc. Defaults to the property name when auto-creating=
 a new property.&nbsp;</span></li>
<li><strong>Conversion factor:</strong> a numeric factor that converts betw=
een data as received and data in "unit with prefix" as above. This conversi=
on factor should be stored as either a power of 10 or in a decimal format, =
not a floating point to avoid destroying precision.&nbsp; Refer to&nbsp;<a =
href=3D"/wiki/spaces/RASNEX/pages/227115037/17.6+Asset+Property+Meta+Data" =
data-linked-resource-id=3D"227115037" data-linked-resource-version=3D"4" da=
ta-linked-resource-type=3D"page">17.6 Asset Property Meta Data</a>&nbsp;</l=
i>
</ol>
<h2 id=3D"id-17.3AssetPropertyManagement-InitialCreation">Initial Creation<=
/h2>
<p>There are two possible ways in which we can create the property metadata=
.</p>
<ol>
<li><span class=3D"inline-comment-marker" data-ref=3D"0302c353-8f58-44ff-bd=
96-6b7de2d0529a">Have the property be created automatically and then have u=
sers set the meta data in the RAS UI. Default to a factor of 1 for float-ty=
pes, and no unit.&nbsp;</span></li>
<li>Require users to create the metadata before the first data is transmitt=
ed</li>
</ol>
<p>Due to internal structures in place at Leclanch=C3=A9, the second option=
 is very impractical. Often new assets are connected to RAS where noone is =
exactly sure what data that asset will produce. We are therefore more or le=
ss forced to go with option 1.&nbsp;</p>
<h2 id=3D"id-17.3AssetPropertyManagement-Approaches">Approaches</h2>
<p>We can either have the preprocessor perform the scale conversion &amp; l=
imit checking during initial processing (offline), or we can perform the co=
nversion every time data is requested (online).</p>
<p>Both have advantages and disadvantages.&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Offline">Offline</h3>
<ul>
<li>More complicated to implement</li>
<li>Much more bug sensitive</li>
<li>Requires coordination between DAE, Preprocessor, ...&nbsp;</li>
<li>Changing scaling factors etc when data has already been received is ver=
y difficult to implement</li>
<li>But best performance</li>
</ul>
<h3 id=3D"id-17.3AssetPropertyManagement-Online">Online</h3>
<ul>
<li>Relatively simple to implement</li>
<li>Probably possible to have the database do this. Just join result table =
with scaling table and multiply. The database can probably do a pretty good=
 job of performing this very quickly.&nbsp;</li>
<li>No issues if the user changes scaling factors.&nbsp;</li>
</ul>
<h2 id=3D"id-17.3AssetPropertyManagement-Presentation&amp;Impact">Presentat=
ion &amp; Impact</h2>
<p><span class=3D"inline-comment-marker" data-ref=3D"be69af3c-4d75-43e3-bcc=
4-aba4faf4fc1f">This section handles the following questions:</span></p>
<ol>
<li>To which data will we apply the scaling (dashboards for sure, but DAE? =
data export? etc)</li>
<li>Will we apply the range limits to data no matter how the data is used (=
eg DAE)?&nbsp;</li>
<li>How will the units field be used?&nbsp;</li>
</ol>
<h3 id=3D"id-17.3AssetPropertyManagement-DataScaling:onwhatdoweapplyit?">Da=
ta Scaling: on what do we apply it?</h3>
<p>For consistency sake, we should apply the data scaling to all possible f=
orms of data retrieval, other than the viewing of raw data in a DataChunk. =
This means the data will be in a logical shape when using</p>
<ul style=3D"list-style-type: square;">
<li>Dashboards</li>
<li>Reports</li>
<li>DAE</li>
<li>Filter Data Export</li>
<li>Filter Preview</li>
</ul>
<h3 id=3D"id-17.3AssetPropertyManagement-Rangelimits:onwhatdoweapplythem?">=
Range limits: on what do we apply them?</h3>
<p>When a value is outside of the allowable range, that value will not be u=
sed by certain RAS components. Others may need the value even when it is ou=
t of range.&nbsp;</p>
<p>Range limits should obviously be applied to&nbsp;</p>
<ul style=3D"list-style-type: square;">
<li>Data displayed in dashboards &amp; reports</li>
<li>Data displayed in filter preview (to ensure same data is shown in dashb=
oard to avoid confusion)</li>
</ul>
<p>The other cases are less obvious.&nbsp;</p>
<h4 id=3D"id-17.3AssetPropertyManagement-DAEinputdata"><strong>DAE input da=
ta</strong></h4>
<p><span class=3D"inline-comment-marker" data-ref=3D"43fb2d3d-1420-4721-996=
2-2afa869185ce">Sometimes we want the unfiltered data in the DAD. Usually w=
e're only interested in the filtered data.</span>&nbsp;</p>
<p>As a result, we should provide the possibility for both. To accomplish t=
his, we will need to add the optional keyword UNFILTERED to the RASQL synta=
x. It will be use as follows:</p>
<div class=3D"code panel pdl" style=3D"border-width: 1px;">
<div class=3D"codeContent panelContent pdl">=20
<pre class=3D"syntaxhighlighter-pre" data-syntaxhighlighter-params=3D"brush=
: java; gutter: false; theme: Confluence" data-theme=3D"Confluence">with as=
set(1) as a
define every(a.test_series) unfiltered as test_series
when test_series =3D=3D 1337 then email("templ")</pre>=20
</div>
</div>
<p>It would also be possible to add this option as an argument to the aggre=
gation function (every, count, ...), but this has the disadvantage of requi=
ring support by each and every aggregator.&nbsp;</p>
<h4 id=3D"id-17.3AssetPropertyManagement-FilterDataExport">Filter Data Expo=
rt</h4>
<p>For simplicity sake, we will apply the range limits to the filter export=
 data. In the future, we may still provide the option to export all data in=
cluding invalid data.&nbsp;</p>
<h4 id=3D"id-17.3AssetPropertyManagement-Units&amp;TheirUsage">Units &amp; =
Their Usage</h4>
<p>Units will be integrated in the parameter name that is shown in dashboar=
ds. For example, when displaying BAT_VOLTAGE in a dashboard, the legend key=
 will be "BAT_VOLTAGE (V)" with V being the unit (volts). In the filter dat=
a export, an extra column will be added (after parameter name) noting the u=
nit.&nbsp;</p>
<p><br></p>
<h2 id=3D"id-17.3AssetPropertyManagement-OnlineConversionDetails">Online Co=
nversion Details</h2>
<p>The online conversion would work as follows: data is received and writte=
n to the database by the preprocessor in the exact format it is received. T=
he preprocessor does not perform bounds checking.&nbsp;</p>
<p>When data is requested, the data retrieval query will be such that only =
data in the provided range is returned. This is already currently implement=
ed for filters.&nbsp;</p>
<h2 id=3D"id-17.3AssetPropertyManagement-OfflineConversionDetails">Offline =
Conversion Details</h2>
<h3 id=3D"id-17.3AssetPropertyManagement-Datamismatchhandling">Data mismatc=
h handling</h3>
<p>We refuse wrongly-typed values in the preprocessor. It should be impossi=
ble to change the type (float or string) once a property is created.&nbsp;<=
/p>
<h3 id=3D"id-17.3AssetPropertyManagement-ChangeManagement">Change Managemen=
t</h3>
<p>Changing the metadata associated with a property has major impact on the=
 data that is stored in the database for that property. When changing one o=
f these metadata parameters, the change will affect&nbsp;<em>all</em> data =
for that asset, both past &amp; present. It is not possible to "only change=
 the scale for data that follows in the future", as timing etc would be too=
 difficult and manual interpretation of database contents too difficult. It=
 would also be very confusing: suppose the user changes the unit from Volts=
 to Amp=C3=A8res, what should be displayed?&nbsp;</p>
<p>When a user wishes to change one of the property metadata fields only fo=
r new data, he should create a new property and use that.&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Minallowablevalue">Min allowable v=
alue&nbsp;</h3>
<p>All data for the property, both data that was previously in-bounds and o=
ut-of-bounds needs to be re-validated.&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Maxallowablevalue">Max allowable v=
alue</h3>
<p>See min allowable value.</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Unit">Unit</h3>
<p>No major impact on the data that is stored. No other database changes re=
quired.&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Receive&amp;StoredScale">Receive &=
amp; Stored Scale</h3>
<p>When changing the receive scale, all values stored for the property have=
 to be scaled by (new scale)/(old scale).&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Recalculationconsequences,part1">R=
ecalculation consequences, part 1</h3>
<p>Changing these parameters forces a complete recalculation for the asset.=
 We also need to consider what will happen if new data arrives while we're =
rewriting the existing data.&nbsp;</p>
<p>The order of operations should be something like this:</p>
<ol>
<li>The rewriting process marks all assets that send data using the propert=
y that is being rewritten as "rewrite-requested" in the database</li>
<li>The preprocessor &amp; dae check if assets are marked this way before s=
tarting a new run. If they are, the run is skipped and will be performed la=
ter on.&nbsp;</li>
<li>The rewriting process waits a few seconds.&nbsp;</li>
<li>The rewriting process checks if there are preprocessor or DAE runs in p=
rogress for any of the assets mentioned in 1. If there are, wait until they=
 are finished.&nbsp;</li>
<li>The rewriting process begins rewriting all relevant data</li>
<li>The rewriting process clears the rewrite-requested flag from all assets=
 it wrote it to.</li>
<li>DAE &amp; Preprocessor regularly check to see if the rewrite-requested =
flag has cleared, and if so they continue as normal.&nbsp;&nbsp;</li>
</ol>
<p>A serious issue with this method is that we lose resume-ability. If the =
rewriting process is stopped halfway through a rewrite, the asset will be m=
arked as rewrite-requested and no preprocessor or DAD's will ever run on da=
ta relating to that asset. As we're rewriting data</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Recalculationconsequences,partDAE"=
>Recalculation consequences, part DAE</h3>
<p>Some parts of recalculation could possibly be done by the DAE. However, =
it is the orchestration of telling the preprocessor to stop while the data =
is being transition that is the difficult part. We would have to add functi=
onality to the DAE that is not used by normal DADs (eg adding the ability t=
o read data that isn't normally visible, adding the ability to validate dat=
a, ...). All of these abilities would then have to have security in place t=
o ensure they can only be executed as part of a conversion job.&nbsp;</p>
<h3 id=3D"id-17.3AssetPropertyManagement-Recalculationconsequences,part3">R=
ecalculation consequences, part 3</h3>
<p>One possibility to make the conversion less impacting on other parts of =
the code, would be to copy rather than edit data.&nbsp;</p>
<p>The order of operations would be the following:</p>
<ol>
<li>Have the conversion process create a new property (preferably hidden an=
d with a separate name).&nbsp;</li>
</ol>
<p><br></p>
<p><br></p>
<p><br></p>
    </div>
</body>
</html>
------=_Part_90_1825437102.1704260532232--
